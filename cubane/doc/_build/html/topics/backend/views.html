

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Backend Views &mdash; Cubane 1.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/cubane.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Backend Model Options" href="model.html" />
    <link rel="prev" title="Backend System" href="index.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          <a href="../../index.html">
            <img src="../../_static/cubane-logo.svg" class="logo" alt="Cubane"/>
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/index.html">Getting started</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Using Cubane</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../resources.html">Working with Resources</a></li>
<li class="toctree-l2"><a class="reference internal" href="../fonts.html">Working with Fonts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../svgicons.html">Working with SVG Icons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../media.html">Working with Media</a></li>
<li class="toctree-l2"><a class="reference internal" href="../settings.html">Settings</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="index.html">Backend System</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="index.html#installing-cubane-s-backend-system">Installing Cubane’s backend system</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="index.html#backend-overview">Backend Overview</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">Backend Views</a></li>
<li class="toctree-l4"><a class="reference internal" href="model.html">Backend Model Options</a></li>
<li class="toctree-l4"><a class="reference internal" href="forms.html">Backend Forms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../cms.html">Content Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="../enquiry.html">Enquiry Forms</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cache.html">Cache System</a></li>
<li class="toctree-l2"><a class="reference internal" href="../favicons.html">Generating Favorite Icons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../deploy.html">Deploying Cubane</a></li>
<li class="toctree-l2"><a class="reference internal" href="../pull.html">Pulling Production Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../test.html">Testing Cubane</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../ref/index.html">Cubane Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Cubane</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Using Cubane</a> &raquo;</li>
        
          <li><a href="index.html">Backend System</a> &raquo;</li>
        
      <li>Backend Views</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/cubaneorg/cubane/blob/master/doc/topics/backend/views.txt" class="fa fa-github" target="_blank"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="backend-views">
<span id="topics-backend-backend-views"></span><h1>Backend Views<a class="headerlink" href="#backend-views" title="Permalink to this headline">¶</a></h1>
<p>A backend view is responsible for managing additional functionality for the
backend system. Usually, a backend view is derived from
<code class="xref py py-class docutils literal"><span class="pre">cubane.views.View</span></code> or <code class="xref py py-class docutils literal"><span class="pre">cubane.views.ModelView</span></code>.</p>
<p>Views are organised into backend sections which then drives the navigation
system.</p>
<div class="section" id="backend-sections">
<span id="topics-backend-sections"></span><h2>Backend Sections<a class="headerlink" href="#backend-sections" title="Permalink to this headline">¶</a></h2>
<p>Cubane’s backend system is using a strict two-level hierarchy for its
navigation system. The first level of navigation usually correlates to a
specific area of interest, such as content items, settings, media assets,
enquiries or accounts. Each section is represented by a backend section, each
can have multiple sub-sections.</p>
<p>For example, the content management system is creating a backend section called
<code class="docutils literal"><span class="pre">Content</span></code> and then creates a separate sub-section for each content type that
is used by the system, such as <code class="docutils literal"><span class="pre">Page</span></code>, <code class="docutils literal"><span class="pre">Case</span> <span class="pre">Studies</span></code> or <code class="docutils literal"><span class="pre">Projects</span></code>.</p>
<p>Most of Cubane’s sub-systems, such as Cubane’s CMS system will automatically
populate various sections based on model classes declared by your application.
However, you may create your own backend sections in order to add your own
functionality to the backend.</p>
<p>In the following example, we will add a new section to the backend system which
shall manage books. In order to install a backend section within the backend
system, declare the following function in your app’s <code class="docutils literal"><span class="pre">__init__.py</span></code> file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">install_backend</span><span class="p">(</span><span class="n">backend</span><span class="p">):</span>
    <span class="kn">from</span> <span class="nn">myApp.backend</span> <span class="kn">import</span> <span class="n">BookShopBackendSection</span>
    <span class="n">backend</span><span class="o">.</span><span class="n">register_section</span><span class="p">(</span><span class="n">BookShopBackendSection</span><span class="p">())</span>
</pre></div>
</div>
<p>Of course, you would need to create your own implementation for a backend
section first. In the example above, we implemented our backend section
<code class="docutils literal"><span class="pre">MyBackendSection</span></code> in the file <code class="docutils literal"><span class="pre">myApp.backend.py</span></code> in the following way:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cubane.backend.views</span> <span class="kn">import</span> <span class="n">BackendSection</span>

<span class="k">class</span> <span class="nc">BookShopBackendSection</span><span class="p">(</span><span class="n">BackendSection</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Book Shop&#39;</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">BooksBackendSection</span><span class="p">(),</span>
        <span class="o">...</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">title</span></code> field declares the visual name of the section as it is presented
within the backend system, which is <code class="docutils literal"><span class="pre">Book</span> <span class="pre">Shop</span></code> in our case.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">We placed our implementation for <code class="docutils literal"><span class="pre">BookShopBackendSection</span></code> in the file
<code class="docutils literal"><span class="pre">backend.py</span></code> for arbitrary reasons. There is no strict requirement on
where your implementation and extensions for the backend system should live.</p>
</div>
<p>Next, we declare a list of sub-sections to be listed within the <code class="docutils literal"><span class="pre">Book</span> <span class="pre">Shop</span></code>
section, which is <code class="docutils literal"><span class="pre">BooksBackendSection</span></code>, which is implemented in a very
similar way to the <code class="docutils literal"><span class="pre">Book</span> <span class="pre">Shop</span></code> section itself:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BooksBackendSection</span><span class="p">(</span><span class="n">BackendSection</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Books&#39;</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">BookView</span>
</pre></div>
</div>
<p>The main difference is that the sub-section does not declare any further
sub-sections but declares a view instead. A view is a class that has been
derived from <code class="xref py py-class docutils literal"><span class="pre">cubane.views.View</span></code>. In most cases, you would want to derive
your view class from <code class="xref py py-class docutils literal"><span class="pre">cubane.views.ModelView</span></code> since it provides a lot of
model-related management capabilities with it, such as listing, searching and
filtering records, as well as the usual, create, edit and delete actions.</p>
<p>However, we will start by looking at its base class first, which is
<code class="xref py py-class docutils literal"><span class="pre">cubane.views.View</span></code>:</p>
</div>
<div class="section" id="view">
<span id="topics-backend-view"></span><h2>View<a class="headerlink" href="#view" title="Permalink to this headline">¶</a></h2>
<p>A <code class="xref py py-class docutils literal"><span class="pre">View</span></code> encapsulates Django’s URL patterns (which you
would usually declare within the <code class="docutils literal"><span class="pre">urls.py</span></code> file) together with view handlers
(which would usually go into the <code class="docutils literal"><span class="pre">views.py</span></code> file). Let’s look at an
example first:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">cubane.views</span> <span class="kn">import</span> <span class="n">View</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_url</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">Book</span>

<span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/&#39;</span><span class="p">,</span>             <span class="s1">&#39;index&#39;</span><span class="p">),</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/(?P&lt;pk&gt;\d+)/&#39;</span><span class="p">,</span> <span class="s1">&#39;book&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;index.html&#39;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;books&#39;</span><span class="p">:</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="p">})</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
        <span class="n">book</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Book</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">render</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="s1">&#39;book.html&#39;</span><span class="p">,</span> <span class="p">{</span>
            <span class="s1">&#39;book&#39;</span><span class="p">:</span> <span class="n">book</span>
        <span class="p">})</span>
</pre></div>
</div>
<p>You declare URL patterns via the <code class="docutils literal"><span class="pre">patterns</span></code> field, which is a list of URL
patterns very similar to how you would declare URL patterns within a
<code class="docutils literal"><span class="pre">urls.py</span></code> file: The first argument to <code class="xref py py-func docutils literal"><span class="pre">view_url()</span></code> declares
the regular expression of the URL pattern, the second argument gives the name
of the view handler as the name of any method of the same class as a string.</p>
<p>Other than that, the implementation behaves in exactly the same way as a
regular Django view handler. You can add decorators, but you need to use the
<code class="xref py py-func docutils literal"><span class="pre">view()</span></code> function in order to do so as shown in the code
example above.</p>
<p>The benefit of combining multiple endpoints into a <code class="xref py py-class docutils literal"><span class="pre">View</span></code>
is that more complex views can be build by deriving from an already existing
view.</p>
<p>You can use a view fully independently of Cubane’s backend system (which is why
it is not bundled within the namespace <code class="docutils literal"><span class="pre">cubane.backend</span></code>), but the concept of
a <code class="xref py py-class docutils literal"><span class="pre">View</span></code> was originally created in order to facilitate
Cubane’s backend system.</p>
<p>You can hook up any number of views within your <code class="docutils literal"><span class="pre">urls.py</span></code> file in the
following way:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.conf.urls</span> <span class="kn">import</span> <span class="n">url</span><span class="p">,</span> <span class="n">include</span>
<span class="kn">from</span> <span class="nn">views</span> <span class="kn">import</span> <span class="n">BookView</span>

<span class="n">books</span> <span class="o">=</span> <span class="n">BooksView</span><span class="p">()</span>

<span class="n">urlpatterns</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;^books/&#39;</span><span class="p">,</span> <span class="n">include</span><span class="p">(</span><span class="n">books</span><span class="o">.</span><span class="n">urls</span><span class="p">))</span>
<span class="p">]</span>
</pre></div>
</div>
<p>A view may implement <em>before</em> and <em>after</em> actions. These are code
implementations that are executed <em>before</em> or <em>after</em> any other view handler
method of the <code class="xref py py-class docutils literal"><span class="pre">View</span></code> is executed:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">before</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">handler</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;before&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;after&#39;</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
        <span class="k">print</span><span class="p">(</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>If you executed the index method of the view, then you should see the following
debug output in your console window:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">before</span>
<span class="n">index</span>
<span class="n">after</span>
</pre></div>
</div>
<p>Which represents the order in which those methods are executed by the system.
Before any view handler method is executed, the <code class="docutils literal"><span class="pre">before</span></code> method is executed.
Then the actual view handler method is executed (in this case <code class="docutils literal"><span class="pre">index</span></code>) and
finally, after the view handler method returned, the <code class="docutils literal"><span class="pre">after</span></code> method is
executed.</p>
<p>The <code class="docutils literal"><span class="pre">handler</span></code> method refers to the actual view handler method that is
currently executed. The <code class="docutils literal"><span class="pre">response</span></code> argument of the <code class="docutils literal"><span class="pre">after</span></code> method refers to
the response object that has been returned by executing the view handler method.</p>
<p>Both methods, <code class="docutils literal"><span class="pre">before</span></code> and <code class="docutils literal"><span class="pre">after</span></code> may return a response object, in which
case the response of the entire request is the response that was returned. If
nothing is returned (<code class="docutils literal"><span class="pre">None</span></code>), then the system will simply return the result
of the view handler, which is usually the result of rendering a template.</p>
<p>If the <code class="docutils literal"><span class="pre">before</span></code> handler returns a response object, then the actual view
handler method is never executed.</p>
<p>The <code class="docutils literal"><span class="pre">after</span></code> method may return a response object, in which case the returned
response object replaces any response that was previously returned by the view
handler method.</p>
</div>
<div class="section" id="template-view">
<span id="topics-backend-template-view"></span><h2>Template View<a class="headerlink" href="#template-view" title="Permalink to this headline">¶</a></h2>
<p>The previous example defined a <code class="xref py py-class docutils literal"><span class="pre">View</span></code> class for presenting
books. Each view handler was using Django’s <code class="xref py py-func docutils literal"><span class="pre">render()</span></code>
method for rendering a template. Cubane provides a simple decorator for
rendering a template via a decorator:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">cubane.views</span> <span class="kn">import</span> <span class="n">View</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_url</span>
<span class="kn">from</span> <span class="nn">cubane.decorators</span> <span class="kn">import</span> <span class="n">template</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">Book</span>

<span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">View</span><span class="p">):</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/&#39;</span><span class="p">,</span>             <span class="s1">&#39;index&#39;</span><span class="p">),</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/(?P&lt;pk&gt;\d+)/&#39;</span><span class="p">,</span> <span class="s1">&#39;book&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="nd">@view</span><span class="p">(</span><span class="n">template</span><span class="p">(</span><span class="s1">&#39;index.html&#39;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;books&#39;</span><span class="p">:</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="nd">@view</span><span class="p">(</span><span class="n">template</span><span class="p">(</span><span class="s1">&#39;book.html&#39;</span><span class="p">))</span>
    <span class="k">def</span> <span class="nf">book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
        <span class="n">book</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Book</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;book&#39;</span><span class="p">:</span> <span class="n">book</span>
        <span class="p">}</span>
</pre></div>
</div>
<p>By using the <code class="xref py py-func docutils literal"><span class="pre">template()</span></code> decorator, we can specify the
template that is used to render any particular view in a more declarative way.
The view simply returns the template context as a dictionary which then becomes
the template context when rendering the corresponding template file.</p>
<p>Please note how the name of the view method (for example <code class="docutils literal"><span class="pre">index</span></code>) correlates
with the name of the template file (<code class="docutils literal"><span class="pre">index.html</span></code>). This is on purpose for
this example, but there is no rule that this has to be this way; neither the
less, this is very common practice when declaring view handlers.</p>
<p>For this reason, Cubane provides a <code class="xref py py-class docutils literal"><span class="pre">cubane.views.TemplateView</span></code> class
that is internally derived from <code class="xref py py-class docutils literal"><span class="pre">cubane.views.View</span></code> and makes use of the
commonly found correlation between the method name and the name of the template
file:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">cubane.views</span> <span class="kn">import</span> <span class="n">TemplateView</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_url</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">Book</span>

<span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/&#39;</span><span class="p">,</span>             <span class="s1">&#39;index&#39;</span><span class="p">),</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/(?P&lt;pk&gt;\d+)/&#39;</span><span class="p">,</span> <span class="s1">&#39;book&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;books&#39;</span><span class="p">:</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
        <span class="n">book</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Book</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;book&#39;</span><span class="p">:</span> <span class="n">book</span>
        <span class="p">}</span>
</pre></div>
</div>
<p>This example demonstrates the use of a <code class="xref py py-class docutils literal"><span class="pre">cubane.views.TemplateView</span></code>. By
deriving the class from <code class="xref py py-class docutils literal"><span class="pre">TemplateView</span></code> instead of
<code class="xref py py-class docutils literal"><span class="pre">View</span></code>, the system will automatically render the template
file which name is derived from the corresponding method name.</p>
<p>Because the name of the index method is <code class="docutils literal"><span class="pre">index</span></code>, the system will
automatically render the template <code class="docutils literal"><span class="pre">index.html</span></code>.</p>
<p>You may want to prefix all templates with a specific path, which can be declared
in the following way:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="s1">&#39;myApp/books/&#39;</span>

    <span class="o">...</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">template_path</span></code> declares the path to the template files that are used by the
<code class="xref py py-class docutils literal"><span class="pre">TemplateView</span></code> class. In this example, the index method
would render to template <code class="docutils literal"><span class="pre">myApp/books/index.html</span></code>.</p>
<p>Internally this behaviour is implemented by overriding the <code class="docutils literal"><span class="pre">after</span></code> method of
the <code class="xref py py-class docutils literal"><span class="pre">View</span></code> class. If you happened to override the <code class="docutils literal"><span class="pre">after</span></code>
method as well, please make sure to call the derived implementation in order to
keep the default behaviour of the <code class="xref py py-class docutils literal"><span class="pre">TemplateView</span></code>, if this
is what you wanted:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">after</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">response</span><span class="p">):</span>
        <span class="c1"># TODO: Insert your code here for example</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">BookView</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">after</span><span class="p">(</span><span class="n">request</span><span class="p">,</span> <span class="n">handler</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="xref py py-class docutils literal"><span class="pre">TemplateView</span></code> class also provides a mechanism to
inject specific render context information for every request:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">TemplateView</span><span class="p">):</span>
    <span class="n">context</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;page_title&#39;</span><span class="p">:</span> <span class="s1">&#39;Books&#39;</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>When rendering any view handler method of the <code class="docutils literal"><span class="pre">BookView</span></code> class, the template
context declared as <code class="docutils literal"><span class="pre">context</span></code> is always part of the resulting template
context that is used to render a template.</p>
<p>Be aware that the context will override any template information that is
returned by a view handler method. If the <code class="docutils literal"><span class="pre">index</span></code> method would return a
dictionary containing <code class="docutils literal"><span class="pre">page_title</span></code>, then such value would always be
overridden by the general context that has been declared for the entire
template view class.</p>
</div>
<div class="section" id="api-view">
<span id="topics-backend-api-view"></span><h2>API View<a class="headerlink" href="#api-view" title="Permalink to this headline">¶</a></h2>
<p>Sometimes a set of view handlers are concerned about generating JSON responses.
We can imagine a JSON-based service endpoint that is concerned with books,
where each view handler will return JSON-encoded data.</p>
<p>Cubane provides the class <code class="xref py py-class docutils literal"><span class="pre">ApiView</span></code> for implementing
API-related views as the next example demonstrates:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">django.shortcuts</span> <span class="kn">import</span> <span class="n">get_object_or_404</span><span class="p">,</span> <span class="n">render</span>
<span class="kn">from</span> <span class="nn">cubane.views</span> <span class="kn">import</span> <span class="n">ApiView</span><span class="p">,</span> <span class="n">view</span><span class="p">,</span> <span class="n">view_url</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">Book</span>

<span class="k">class</span> <span class="nc">BookApiView</span><span class="p">(</span><span class="n">ApiView</span><span class="p">):</span>
    <span class="n">patterns</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/&#39;</span><span class="p">,</span>             <span class="s1">&#39;index&#39;</span><span class="p">),</span>
        <span class="n">view_url</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;books/(?P&lt;pk&gt;\d+)/&#39;</span><span class="p">,</span> <span class="s1">&#39;book&#39;</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">index</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;books&#39;</span><span class="p">:</span> <span class="n">Book</span><span class="o">.</span><span class="n">objects</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="nd">@view</span><span class="p">(</span><span class="n">require_GET</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">book</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">request</span><span class="p">,</span> <span class="n">pk</span><span class="p">):</span>
        <span class="n">book</span> <span class="o">=</span> <span class="n">get_object_or_404</span><span class="p">(</span><span class="n">Book</span><span class="p">,</span> <span class="n">pk</span><span class="o">=</span><span class="n">pk</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s1">&#39;book&#39;</span><span class="p">:</span> <span class="n">book</span>
        <span class="p">}</span>
</pre></div>
</div>
<p>The only difference from the previous example is the fact that we derived from
<code class="xref py py-class docutils literal"><span class="pre">ApiView</span></code> and not from
<code class="xref py py-class docutils literal"><span class="pre">TemplateView</span></code>.</p>
<p>While <code class="xref py py-class docutils literal"><span class="pre">TemplateView</span></code> will render a particular template
file, <code class="xref py py-class docutils literal"><span class="pre">ApiView</span></code> will simply take the result returned from
a view handler method and encodes it into JSON. Encoded JSON is then packed
into an HTTP response object with the content encoding <code class="docutils literal"><span class="pre">text/javascript</span></code>.</p>
</div>
<div class="section" id="model-view">
<span id="topics-backend-model-view"></span><h2>Model View<a class="headerlink" href="#model-view" title="Permalink to this headline">¶</a></h2>
<p>A <code class="xref py py-class docutils literal"><span class="pre">ModelView</span></code> is derived from
<code class="xref py py-class docutils literal"><span class="pre">TemplateView</span></code> and forms the basis for most views as part
of the backend system.</p>
<p>A model view provides a wast amount of functionality for a particular model:</p>
<ul class="simple">
<li>Multi-column listing of model instances</li>
<li>Create, Update, Duplicate, Delete</li>
<li>Sequential Ordering</li>
<li>Sorting, Searching and Filtering</li>
<li>Folders and <em>Drag and Drop</em></li>
</ul>
<p>Let’s look at a simple example, where we derive our own class from
<code class="xref py py-class docutils literal"><span class="pre">ModelView</span></code> in order to provide backend functionality for
managing books:</p>
<div class="highlight-python"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cubane.backend.views</span> <span class="kn">import</span> <span class="n">BackendSection</span>
<span class="kn">from</span> <span class="nn">cubane.views</span> <span class="kn">import</span> <span class="n">ModelView</span>
<span class="kn">from</span> <span class="nn">models</span> <span class="kn">import</span> <span class="n">Book</span>

<span class="k">class</span> <span class="nc">BookView</span><span class="p">(</span><span class="n">ModelView</span><span class="p">):</span>
    <span class="n">template_path</span> <span class="o">=</span> <span class="s1">&#39;cubane/backend/&#39;</span>
    <span class="n">model</span> <span class="o">=</span> <span class="n">Book</span>

<span class="k">class</span> <span class="nc">BooksBackendSection</span><span class="p">(</span><span class="n">BackendSection</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Books&#39;</span>
    <span class="n">view</span> <span class="o">=</span> <span class="n">BookView</span>

<span class="k">class</span> <span class="nc">BookShopBackendSection</span><span class="p">(</span><span class="n">BackendSection</span><span class="p">):</span>
    <span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Book Shop&#39;</span>
    <span class="n">sections</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">BooksBackendSection</span><span class="p">()</span>
    <span class="p">]</span>
</pre></div>
</div>
<p>The example above links all parts together: It declares a new top-level backend
section <code class="docutils literal"><span class="pre">BookShopBackendSection</span></code> with the name <code class="docutils literal"><span class="pre">Book</span> <span class="pre">Shop</span></code> that contains
one sub-section <code class="docutils literal"><span class="pre">BooksBackendSection</span></code> with the name <code class="docutils literal"><span class="pre">Books</span></code> which then
presents a model view <code class="docutils literal"><span class="pre">BookView</span></code> which operates on the <code class="docutils literal"><span class="pre">Book</span></code> model.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">For most entities, you do not necessarily have to declare this structure by
yourself. For example, if you derived any models from
<code class="xref py py-class docutils literal"><span class="pre">cubane.cms.models.Entity</span></code> then Cubane’s CMS component will
automatically generate appropriate backend views for you.</p>
</div>
<p>Of course, the presentation and functionality of a
<code class="xref py py-class docutils literal"><span class="pre">ModelView</span></code> can be customised and extended. This section
will provide more information on extending the <code class="xref py py-class docutils literal"><span class="pre">ModelView</span></code>
itself.</p>
<p>However, the behaviour of a <code class="xref py py-class docutils literal"><span class="pre">ModelView</span></code> is also driven by
the model itself, since under most circumstances we are not involved in
customising the <code class="xref py py-class docutils literal"><span class="pre">ModelView</span></code> directly.</p>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last">Please refer to the <a class="reference internal" href="model.html#topics-backend-model-view-options"><span class="std std-ref">Model View Options</span></a> section for
more information on how to control the presentation of a
<code class="xref py py-class docutils literal"><span class="pre">ModelView</span></code> by declaring backend-specific options
through the corresponding model class.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="model.html" class="btn btn-neutral float-right" title="Backend Model Options" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="Backend System" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Cubane.org.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

    <div class="wy-nav-contact">
        <a class="wy-nav-contact-email" href="mailto:hello@cubane.org">hello@cubane.org</a>
        <a class="wy-nav-contact-twitter" href="http://twitter.com/CubaneLtd" target="_blank">
            <img src="../../_static/twitter.svg" alt="Cubane on GitHub"/>
        </a>

        <a class="wy-nav-contact-github" href="https://github.com/cubaneorg/cubane" target="_blank">
            <img src="../../_static/github.svg" alt="Cubane on GitHub"/>
        </a>
    </div>
  </div>

  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../../',
            VERSION:'1.0',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../../_static/jquery.js"></script>
      <script type="text/javascript" src="../../_static/underscore.js"></script>
      <script type="text/javascript" src="../../_static/doctools.js"></script>

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>